<div class="container-fluid">
  <div class="row p-2 bg-info">
    <div class="col-6">
      <h3>Class Schedule List</h3>
    </div>
    <div class="col-6 text-end">
      <button class="btn btn-warning" (click)="openModal()">Add Schedule</button>
    </div>
  </div>

  <div class="row mt-3">
    <div *ngIf="schedules.length === 0">
      <h5 class="text-center p-5">No class schedules found</h5>
    </div>
    <table class="table table-bordered" *ngIf="schedules.length > 0">
      <thead>
        <tr>
          <th>SL No</th>
          <th>Date</th>
          <th>Slot</th>
          <th>Days</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of schedules; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ item.scheduleDate | date: 'mediumDate' }}</td>
          <td>{{ getSlotTime(item.slotId) }}</td>
          <td>{{ (item.selectedDays) }}</td>
          <td>{{ item.isActive ? 'Active' : 'Inactive' }}</td>
          <td>
            <button class="btn btn-primary btn-sm" (click)="showEditForm(item)">Edit</button>
            <button class="btn btn-danger btn-sm" (click)="deleteSchedule(item.classScheduleId)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="scheduleModal" #scheduleModal>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-info text-white">
        <h5 class="modal-title">{{ isEditMode ? 'Edit' : 'Add' }} Class Schedule</h5>
        <button type="button" class="btn-close" (click)="closeModal()"></button>
      </div>

      <form [formGroup]="scheduleForm" (ngSubmit)="onSubmit()">
        <div class="modal-body">
          <div class="mb-3">
            <label>Date</label>
            <input type="date" class="form-control" formControlName="scheduleDate" required />
          </div>

          <div class="mb-3">
            <label>Slot</label>
            <select class="form-select" formControlName="slotId" required>
              <option value="">Select a slot</option>
              <option *ngFor="let slot of slots" [value]="slot.slotID" [selected]="slot.slotID === scheduleForm.get('slotId')?.value">
                {{ slot.timeSlotType }} ({{ slot.startTime }} - {{ slot.endTime }})
              </option>
            </select>
          </div>

          <div class="form-group">
            <label>Class Days</label>
            <div class="form-check" *ngFor="let day of days">
              <input type="checkbox"
                     class="form-check-input"
                     [value]="day.dayId"
                     [checked]="scheduleForm.get('selectedDayIds')?.value?.includes(day.dayId)"
                     (change)="onCheckboxChange($event)"
                     id="dayCheckbox{{ day.dayId }}" />
              <label class="form-check-label" [for]="'dayCheckbox' + day.dayId">
                {{ day.dayName }}
              </label>
            </div>
          </div>

          <div class="form-check mb-3">
            <input type="checkbox" class="form-check-input" id="isActiveCheckbox" formControlName="isActive" />
            <label class="form-check-label" for="isActiveCheckbox">Is Active?</label>
          </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-success" [disabled]="scheduleForm.invalid">
            {{ isEditMode ? 'Update' : 'Save' }}
          </button>
          <button type="button" class="btn btn-secondary" (click)="closeModal()">Close</button>
        </div>
      </form>
    </div>
  </div>
</div>
